CREATE TABLE USER(
	Email VARCHAR(50) NOT NULL,
	Username CHAR(50) NOT NULL, 
	Password CHAR(40) NOT NULL, 
	User_type TINYINT NOT NULL, 
	CONSTRAINT UPK PRIMARY KEY (Username), 
	CONSTRAINT PSK UNIQUE (Email));

CREATE TABLE PROPERTY(
	Name VARCHAR(50) NOT NULL,
	ID INT(5) ZEROFILL NOT NULL AUTO_INCREMENT,
	Size_Acres DECIMAL(10,2) NOT NULL,
	St_Address VARCHAR(50) NOT NULL,
	City VARCHAR(50) NOT NULL,
	ZIP CHAR(5) NOT NULL,
	IsPublic TINYINT NOT NULL,
	IsComm TINYINT NOT NULL,
	User_Name VARCHAR(50) NOT NULL,
	Admin_Name VARCHAR(50),
	Property_Type VARCHAR(50) NOT NULL,
	CONSTRAINT PPK PRIMARY KEY(ID),
	CONSTRAINT PSK UNIQUE(Name),
	CONSTRAINT UFK FOREIGN KEY (User_Name) REFERENCES USER(Username) 
		ON DELETE CASCADE ON UPDATE CASCADE,
	CONSTRAINT UFKK FOREIGN KEY (Admin_Name) REFERENCES USER(Username)
		ON DELETE SET NULL ON UPDATE CASCADE);

CREATE TABLE ITEM(
	I_Name VARCHAR(50) NOT NULL,
	IsApproved TINYINT NOT NULL,
	Item_Type VARCHAR(15) NOT NULL,
	CONSTRAINT IPK PRIMARY KEY (I_Name));

CREATE TABLE VISIT(
	U_ID VARCHAR(50) NOT NULL,
	P_ID INT(5) ZEROFILL NOT NULL,
	Date DATE NOT NULL,
	Rating INT NOT NULL,
	CONSTRAINT VPK PRIMARY KEY(U_ID, P_ID),
	CONSTRAINT VFK FOREIGN KEY(U_ID) REFERENCES USER(Username)
		ON DELETE CASCADE ON UPDATE CASCADE,
	CONSTRAINT VFKK FOREIGN KEY (P_ID) REFERENCES PROPERTY(ID)
		ON DELETE CASCADE ON UPDATE CASCADE);

CREATE TABLE PROPERTY_HAS_ITEM(
	P_ID INT(5) ZEROFILL NOT NULL AUTO_INCREMENT,
	I_Name VARCHAR(50) NOT NULL,
	CONSTRAINT PIPK PRIMARY KEY(P_ID, I_Name),
	CONSTRAINT PIFK FOREIGN KEY(P_ID) REFERENCES PROPERTY(ID)
		ON DELETE CASCADE ON UPDATE CASCADE,
	CONSTRAINT PIFKK FOREIGN KEY(I_Name) REFERENCES ITEM(I_Name)
		ON DELETE CASCADE ON UPDATE CASCADE);